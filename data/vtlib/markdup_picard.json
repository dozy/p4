{
"version":"2.0",
"description":"steps in the alignment pipeline to post-process bam files produced by the AlignmentFilter",
"subgraph_io":{
	"ports":{
		"inputs":{ "_stdin_":"fixmate" },
		"outputs":{ "_stdout_":"coord_sort" }
	}
},
"nodes":[
	{
		"id":"fixmate",
		"type":"EXEC",
		"use_STDIN": true,
		"use_STDOUT": true,
		"cmd": [ {"subst":"samtools_executable", "required":true, "ifnull":"samtools"}, "fixmate", "--threads", {"subst":"fixmate_threads","required":true,"ifnull":1}, "-m", "-", "-" ]
	},
	{
		"id":"name_sort",
		"type":"EXEC",
		"use_STDIN": true,
		"use_STDOUT": true,
		"cmd": [ {"subst":"samtools_executable", "required":true, "ifnull":"samtools"}, "sort", "-n", "-l", "0", "--threads", {"subst":"name_sort_threads","required":true,"ifnull":4}, "-" ]
	},
	{
		"id":"markdup",
		"type":"EXEC",
		"use_STDIN": true,
		"use_STDOUT": true,
		"comment":"add -T <temp_prefix> after initial tests",
		"cmd": [ {"subst":"samtools_executable", "required":true, "ifnull":"samtools"}, "markdup", "--threads", {"subst":"markdup_threads","required":true,"ifnull":1}, "-f", {"subst":"stmd_metrics_file","required":true}, "-S", "-s", "-", "-" ]
	},
	{ "id":"md_output", "type":"RAFILE", "name":{"subst":"md_output","ifnull":"md_output.bam"} },
	{
		"id":"coord_sort",
		"type":"EXEC",
		"use_STDIN": true,
		"use_STDOUT": true,
		"cmd": [ {"subst":"samtools_executable", "required":true, "ifnull":"samtools"}, "sort", "-l", "0", "--threads", {"subst":"coord_sort_threads","required":true,"ifnull":4}, "-" ]
	}
],
"edges":[

	{ "id":"fixmate_to_coordsort", "from":"fixmate", "to":"name_sort" },
	{ "id":"namesort_tomarkdup", "from":"name_sort", "to":"markdup" },
	{ "id":"markdup_to_multiway", "from":"markdup", "to":"md_output" },
	{ "id":"markdup_to_multiway", "from":"md_output", "to":"coord_sort" }
]
}
